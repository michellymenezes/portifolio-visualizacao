<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8">
<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="">
<meta name="generator" content="Hugo 0.30.2" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://michellymenezes.github.io/portifolio-visualizacao/css/style.css" type="text/css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700" type="text/css">
<link rel="alternate" href="https://michellymenezes.github.io/index.xml" type="application/rss+xml" title="Portifólio Visualização">
<title>Fluxo na sociedade - Portifólio Visualização</title>
</head>
<body>

<header>
  <div class="container clearfix">
    <a class="path" href="https://michellymenezes.github.io/portifolio-visualizacao/">[Portifólio Visualização]</a>
    <span class="caret"># _</span>
    <div class="right">
      
    </div>
  </div>
</header>

<div class="container">


<main role="main" class="article">
  
<article class="single" itemscope itemtype="http://schema.org/BlogPosting">
  <div class="meta">

    <span class="key">published on</span>
    <span class="val"><time itemprop="datePublished" datetime="2017-12-05">December 05, 2017</time></span>



  </div>
  <h1 class="headline" itemprop="headline">Fluxo na sociedade</h1>
  <section class="body" itemprop="articleBody">
    <!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="utf-8">
  <title>Barras simples</title>
  <script src="https://d3js.org/d3.v4.min.js"></script>
</head>

<body>
  <div class="container">
    <div class="row">
      <h1>O que o fluxo da mobilidade pode nos contar sobre a sociedade?</h1>
    </div>
    <div class="row mychart" id="chart1">
    </div>
  </div>

  <style>
    .mychart rect {
      fill: steelblue;
    }

    .mychart dot {
      stroke: #000;
    }

    .mychart rect:hover {
      fill: goldenrod;
    }

    .mychart text {
      font: 12px sans-serif;
      text-anchor: left;
    }

    .mychart tooltip {
      position: absolute;
      width: 200px;
      height: 28px;
      pointer-events: none;
    }

    .mychart rect.bordered {
      stroke: #E6E6E6;
      stroke-width:2px;
    }

    .mychart text.mono {
      font-size: 9pt;
      font-family: Consolas, courier;
      fill: #818080;
    }

    .mychart text.axis-grupo {
      fill: #818080;
    }

    .mychart text.axis-horas {
      fill: #818080;
    }`
  </style>

  <script type="text/javascript">
    "use strict"


      function onlyUnique(value, index, self) {
          return self.indexOf(value) === index;
      }

      function tipoToNum(tipo) {
        if (tipo === "carros") return 0;
        if (tipo === "motos") return 1;
        if (tipo === "caminhoes") return 2;
        if (tipo === "onibus") return 3;
        if (tipo === "total_ciclistas") return 4;
        return 5;
      }

      function pickColor(colors, n, tipo){
        n = Math.floor(n/205*9);
        return colors[n]
      }
      // Preencha aqui.

      var alturaSVG = 400, larguraSVG = 600;
      var	margin = {top: 50, right: 40, bottom:100, left:80}, // para descolar a vis das bordas do grafico
          larguraVis = larguraSVG - margin.left - margin.right,
          alturaVis = alturaSVG - margin.top - margin.bottom,
          gridSize = Math.floor(larguraVis / 15),
          legendElementWidth = Math.floor(larguraVis / 9),
          buckets = 9,
          colors = ["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]; // alternatively colorbrewer.YlGnBu[9];



      /*
       * Prepara onde adicionaremos a visualizacao
       */
      var grafico = d3.select('#chart1') // cria elemento <svg> com um <g> dentro
        .append('svg')
          .attr('width', larguraVis + margin.left + margin.right)
          .attr('height', alturaVis + margin.top + margin.bottom)
        .append('g') // para entender o <g> vá em x03-detalhes-svg.html
          .attr('transform', 'translate(' +  margin.left + ',' + margin.top + ')');

      var grupoLabels = grafico.selectAll(".grupoLabel")
          .data(["Carros", "Motos", "Caminhoes", "Onibus", "Ciclistas", "Pedestres"])
          .enter().append("text")
            .text(function (d) { return d; })
            .attr("x", 0)
            .attr("y", function (d, i) { return i * gridSize; })
            .style("text-anchor", "end")
            .attr("transform", "translate(-6," + gridSize / 1.5 + ")")
            .attr("class", function (d, i) { return "grupoLabel mono axis axis-grupo"; });

      var timeLabels = grafico.selectAll(".timeLabel")
                .data([6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20])
                .enter().append("text")
                  .text(function(d) { return d; })
                  .attr("x", function(d, i) { return i * gridSize; })
                  .attr("y", 0)
                  .style("text-anchor", "middle")
                  .attr("transform", "translate(" + gridSize / 2 + ", -6)")
                  .attr("class", function(d, i) { return "timeLabel mono axis"; });


      var heatmapChart = function() {
        d3.csv("https://raw.githubusercontent.com/michellymenezes/portifolio-visualizacao/master/data/tipos-fluxo-campina-median.csv",

        function(error, dados) {
          // var colorScale = d3.scaleQuantile()
          //     .domain([0, buckets - 1, d3.max(dados, function (d) { return d.n; })])
          //     .range(colors);

          var colorScale = d3.scaleThreshold()
              .domain([0, 10, 30, 70, 100, 120, 150, 170, 190])
              .range([0].concat(colors));

          var cards = grafico.selectAll(".hour")
              .data(dados);

          cards.append("title");

          cards.enter().append("rect")
              .attr("x", function(d) { return (d.hora - 6) * gridSize; })
              .attr("y", function(d) { return (tipoToNum(d.tipo)) * gridSize; })
              .attr("rx", 4)
              .attr("ry", 4)
              .attr("class", "hour bordered")
              .attr("width", gridSize)
              .attr("height", gridSize)
              .style("fill", function(d) { return pickColor(colors, d.n, d.tipo)});

          cards.transition().duration(1000)
              .style("fill", function(d) { return colorScale(d.n); });

          cards.select("title").text(function(d) { return d.n; });

          cards.exit().remove();

          var legend = grafico.selectAll(".legend")
              .data(colorScale.domain(), function(d) { return d; })
              .enter().append("g")
              .attr("class", "legend");

          legend.append("rect")
            .attr("x", function(d, i) { return legendElementWidth * i; })
            .attr("y", alturaVis)
            .attr("width", legendElementWidth)
            .attr("height", gridSize / 2)
            .style("fill", function(d, i) { return colors[i]; });

          legend.append("text")
            .attr("class", "mono")
            .text(function(d) { return "≥ " + Math.round(d); })
            .attr("x", function(d, i) { return legendElementWidth * i; })
            .attr("y", alturaVis + gridSize);

          legend.exit().remove();

        });
      };

      heatmapChart();

  </script>
</body>

</html>

  </section>
</article>

</main>


</div>

<footer>
  <div class="container">
    <span class="copyright">&copy; 2017  Portifólio Visualização - <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></span>
  </div>
</footer>

</body>
</html>

